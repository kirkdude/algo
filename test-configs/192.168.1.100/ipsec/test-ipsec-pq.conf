# Post-quantum IPsec configuration template
# Generated by Algo VPN quantum-safe role
# strongSwan 6.0+ with ML-KEM support

config setup
    uniqueids=never # allow multiple connections per user
    charondebug="ike 2, knl 2, cfg 2, net 2, esp 2, dmn 2,  mgr 2"

conn %default
    fragmentation=yes
    rekey=no
    dpdaction=clear
    keyexchange=ikev2
    compress=yes
    dpddelay=35s
    lifetime=3h
    ikelifetime=12h

    # Hybrid classical + post-quantum configuration
    ike=aes256gcm16-prfsha512-ecp384-ke1_mlkem768!
    esp=aes256gcm16-sha256!

    left=%any
    leftauth=pubkey
    leftid=192.168.1.100
    leftcert=192.168.1.100.crt
    leftsendcert=always
    leftsubnet=0.0.0.0/0,::/0

    right=%any
    rightauth=pubkey
    rightsourceip=10.48.0.0/16,2001:db8:4160::/48
    rightdns=172.16.0.1

# Post-quantum enhanced connection
conn ikev2-pq-pubkey
    auto=add
    # Enhanced logging for post-quantum connections
    mark=%unique

# Compatibility connection for classical clients
conn ikev2-pubkey-fallback
    auto=add
    ike=aes256gcm16-prfsha512-ecp384!
    esp=aes256gcm16-ecp384!
