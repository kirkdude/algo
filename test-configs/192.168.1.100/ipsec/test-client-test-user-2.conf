# Quantum-Safe strongSwan Client Configuration
# Generated by Algo VPN quantum-safe role
# Requires strongSwan 6.0+ with LibOQS support

conn algovpn-pq-192.168.1.100
    # Connection parameters
    fragmentation=yes
    rekey=no
    dpdaction=clear
    keyexchange=ikev2
    compress=no
    dpddelay=35s
    lifetime=3h
    ikelifetime=12h

    # Hybrid classical + post-quantum algorithms
    ike=aes256gcm16-prfsha512-ecp384-ke1_mlkem768!
    esp=aes256gcm16-sha256!

    # Server configuration
    right=192.168.1.100
    rightid=192.168.1.100
    rightsubnet=0.0.0.0/0
    rightauth=pubkey

    # Client configuration
    leftsourceip=%config
    leftauth=pubkey
    leftcert=test-user-2.crt
    leftfirewall=yes
    left=%defaultroute

    # Auto-start
    auto=add

# Fallback connection for compatibility
conn algovpn-fallback-192.168.1.100
    fragmentation=yes
    rekey=no
    dpdaction=clear
    keyexchange=ikev2
    compress=no
    dpddelay=35s

    # Classical algorithms only
    ike=aes256gcm16-prfsha512-ecp384!
    esp=aes256gcm16-ecp384!

    right=192.168.1.100
    rightid=192.168.1.100
    rightsubnet=0.0.0.0/0
    rightauth=pubkey

    leftsourceip=%config
    leftauth=pubkey
    leftcert=test-user-2.crt
    leftfirewall=yes
    left=%defaultroute

    auto=add
