# LibOQS Algorithm Configuration
# Generated by Algo VPN quantum-safe role
# Timestamp: {{ ansible_date_time.iso8601 }}

# Supported ML-KEM (Key Encapsulation Mechanism) Algorithms
[ML-KEM]
{% for algorithm in quantum_safe_algorithms.ml_kem %}
{{ algorithm | upper | replace('-', '_') }} = {{ algorithm }}
{% endfor %}

# Supported ML-DSA (Digital Signature Algorithm) Algorithms
[ML-DSA]
{% for algorithm in quantum_safe_algorithms.ml_dsa %}
{{ algorithm | upper | replace('-', '_') }} = {{ algorithm }}
{% endfor %}

# Security Level Mapping
[SECURITY_LEVELS]
# NIST Security Categories
CATEGORY_1 = ML-KEM-512, ML-DSA-44  # 128-bit classical security
CATEGORY_3 = ML-KEM-768, ML-DSA-65  # 192-bit classical security
CATEGORY_5 = ML-KEM-1024, ML-DSA-87 # 256-bit classical security

# Default Algorithms
[DEFAULTS]
DEFAULT_KEM = {{ default_security_level }}
DEFAULT_SIGNATURE = {{ default_signature_level }}
SECURITY_MODE = {{ quantum_safe_mode | default('hybrid') }}

# Performance Optimization Settings
[PERFORMANCE]
OPTIMIZATION_LEVEL = {{ quantum_safe_optimization | default('generic') }}
{% if quantum_safe_optimization == 'avx2' %}
AVX2_ENABLED = true
{% else %}
AVX2_ENABLED = false
{% endif %}
{% if quantum_safe_optimization == 'aarch64' %}
NEON_ENABLED = true
{% else %}
NEON_ENABLED = false
{% endif %}

# Algorithm Parameters
[PARAMETERS]
{% for algorithm in quantum_safe_algorithms.ml_kem %}
{% if algorithm == 'ML-KEM-512' %}
{{ algorithm | upper | replace('-', '_') }}_PUBLIC_KEY_SIZE = 800
{{ algorithm | upper | replace('-', '_') }}_SECRET_KEY_SIZE = 1632
{{ algorithm | upper | replace('-', '_') }}_CIPHERTEXT_SIZE = 768
{% elif algorithm == 'ML-KEM-768' %}
{{ algorithm | upper | replace('-', '_') }}_PUBLIC_KEY_SIZE = 1184
{{ algorithm | upper | replace('-', '_') }}_SECRET_KEY_SIZE = 2400
{{ algorithm | upper | replace('-', '_') }}_CIPHERTEXT_SIZE = 1088
{% elif algorithm == 'ML-KEM-1024' %}
{{ algorithm | upper | replace('-', '_') }}_PUBLIC_KEY_SIZE = 1568
{{ algorithm | upper | replace('-', '_') }}_SECRET_KEY_SIZE = 3168
{{ algorithm | upper | replace('-', '_') }}_CIPHERTEXT_SIZE = 1568
{% endif %}
{% endfor %}

# Integration Settings
[INTEGRATION]
STRONGSWAN_INTEGRATION = {{ integrate_with_strongswan | lower }}
WIREGUARD_INTEGRATION = {{ integrate_with_wireguard | lower }}
HYBRID_MODE = {{ create_hybrid_configs | lower }}
FALLBACK_MODE = {{ enable_fallback_mode | lower }}

# Development and Testing
[DEVELOPMENT]
DEV_MODE = {{ quantum_safe_dev_mode | lower }}
TESTING_ENABLED = {{ quantum_safe_testing | lower }}
BENCHMARKS_ENABLED = {{ quantum_safe_benchmarks | lower }}
DETERMINISTIC_KEYS = {{ quantum_safe_deterministic_keys | lower }}

# Logging and Monitoring
[LOGGING]
LOG_LEVEL = {{ quantum_safe_logging | default('info') }}
PERFORMANCE_MONITORING = {{ performance_monitoring | lower }}

# Library Paths
[PATHS]
LIBOQS_INSTALL_DIR = {{ liboqs_install_dir }}
LIBOQS_BUILD_DIR = {{ liboqs_build_dir }}
STRONGSWAN_INSTALL_DIR = {{ strongswan_install_dir }}
CONFIG_DIR = /opt/quantum-safe/configs
LOG_DIR = /opt/quantum-safe/logs
TEST_DIR = /opt/quantum-safe/tests
